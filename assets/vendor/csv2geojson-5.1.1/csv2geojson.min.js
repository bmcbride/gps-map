!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).csv2geojson=e()}(function(){return function n(o,i,u){function a(r,e){if(!i[r]){if(!o[r]){var t="function"==typeof require&&require;if(!e&&t)return t(r,!0);if(s)return s(r,!0);throw(t=new Error("Cannot find module '"+r+"'")).code="MODULE_NOT_FOUND",t}t=i[r]={exports:{}},o[r][0].call(t.exports,function(e){return a(o[r][1][e]||e)},t,t.exports,n,o,i,u)}return i[r].exports}for(var s="function"==typeof require&&require,e=0;e<u.length;e++)a(u[e]);return a}({1:[function(e,r,t){"use strict";var m=e("d3-dsv"),g=e("@mapbox/sexagesimal"),n=/(Lat)(itude)?/gi,o=/(L)(on|ng)(gitude)?/i;function i(e,r){var t,n,o,i;for(i in e)(n=i.match(r))&&(!t||n[0].length/i.length>o)&&(o=n[0].length/i.length,t=i);return t}function h(e){return i(e,n)}function y(e){return i(e,o)}function u(e){return"object"==typeof e?Object.keys(e).length:0}function F(o){var i=[];return[",",";","\t","|"].forEach(function(e){var r=m.dsvFormat(e).parse(o);if(1<=r.length){for(var t=u(r[0]),n=0;n<r.length;n++)if(u(r[n])!==t)return;i.push({delimiter:e,arity:Object.keys(r[0]).length})}}),i.length?i.sort(function(e,r){return r.arity-e.arity})[0].delimiter:null}r.exports={isLon:function(e){return!!e.match(o)},isLat:function(e){return!!e.match(n)},guessLatHeader:h,guessLonHeader:y,csv:m.csvParse,tsv:m.tsvParse,dsv:m,auto:function(e){var r=F(e);return r?(delete(e=m.dsvFormat(r).parse(e)).columns,e):null},csv2geojson:function(e,r,t){t||(t=r,r={}),r.delimiter=r.delimiter||",";var n=r.latfield||"",o=r.lonfield||"",i=r.crs||"",u=[],a={type:"FeatureCollection",features:u};if(""!==i&&(a.crs={type:"name",properties:{name:i}}),"auto"!==r.delimiter||"string"!=typeof e||(r.delimiter=F(e),r.delimiter)){var s=r.numericFields?r.numericFields.split(","):null,l="string"==typeof e?m.dsvFormat(r.delimiter).parse(e,function(e){if(s)for(var r in e)s.includes(r)&&(e[r]=+e[r]);return e}):e;if(l.length){var f,c,p,d,v=[],n=n||h(l[0]),o=o||y(l[0]);if(!n||!o){for(f=0;f<l.length;f++)u.push({type:"Feature",properties:l[f],geometry:null});t(v.length?v:null,a)}else{for(f=0;f<l.length;f++)void 0!==l[f][o]&&void 0!==l[f][n]&&(c=l[f][o],p=l[f][n],(d=g(c,"EW"))&&(c=d),(d=g(p,"NS"))&&(p=d),c=parseFloat(c),p=parseFloat(p),isNaN(c)||isNaN(p)?v.push({message:"A row contained an invalid value for latitude or longitude",row:l[f],index:f}):(r.includeLatLon||(delete l[f][o],delete l[f][n]),u.push({type:"Feature",properties:l[f],geometry:{type:"Point",coordinates:[parseFloat(c),parseFloat(p)]}})));t(v.length?v:null,a)}}else t(null,a)}else t({type:"Error",message:"Could not autodetect delimiter"})},toLine:function(e){for(var r=e.features,t={type:"Feature",geometry:{type:"LineString",coordinates:[]}},n=0;n<r.length;n++)t.geometry.coordinates.push(r[n].geometry.coordinates);return t.properties=r.reduce(function(e,r){for(var t in r.properties)e[t]||(e[t]=[]),e[t].push(r.properties[t]);return e},{}),{type:"FeatureCollection",features:[t]}},toPolygon:function(e){for(var r=e.features,t={type:"Feature",geometry:{type:"Polygon",coordinates:[[]]}},n=0;n<r.length;n++)t.geometry.coordinates[0].push(r[n].geometry.coordinates);return t.properties=r.reduce(function(e,r){for(var t in r.properties)e[t]||(e[t]=[]),e[t].push(r.properties[t]);return e},{}),{type:"FeatureCollection",features:[t]}}}},{"@mapbox/sexagesimal":2,"d3-dsv":3}],2:[function(e,r,t){function n(e,r){r=o(e,r);return r.whole+"° "+(r.minutes?r.minutes+"' ":"")+(r.seconds?r.seconds+'" ':"")+r.dir}function o(e,r){var t=({lat:["N","S"],lon:["E","W"]}[r]||"")[0<=e?0:1],n=Math.abs(e),r=Math.floor(n),e=60*(n-r),n=Math.floor(e);return{whole:r,minutes:n,seconds:Math.floor(60*(e-n)),dir:t}}function i(e,r,t){if(r=r||"NSEW","string"!=typeof e)return{val:null,regex:t};var n=(t=t||/[\s\,]*([NSEW])?\s*([\-|\—|\―]?[0-9.]+)°?\s*(?:([0-9.]+)['’′‘]\s*)?(?:([0-9.]+)(?:''|"|”|″)\s*)?([NSEW])?/gi).exec(e);if(!n)return{val:null,regex:t};e=n[1]||n[5];return e&&-1===r.indexOf(e)?{val:null,regex:t}:{val:((n[2]?parseFloat(n[2]):0)+(n[3]?parseFloat(n[3])/60:0)+(n[4]?parseFloat(n[4])/3600:0))*("S"===e||"W"===e?-1:1),regex:t,raw:n[0],dim:e}}r.exports=function(e,r){return i(e,r).val},r.exports.pair=function(e,r){var t=i(e=e.trim(),r);if(null===t.val)return null;r=i(e,r,t.regex);if(null===r.val)return null;if(t.raw+r.raw!==e)return null;return t.dim?function(e,r,t){if("N"===t||"S"===t)return[e,r];if("W"===t||"E"===t)return[r,e]}(t.val,r.val,t.dim):[t.val,r.val]},r.exports.format=n,r.exports.formatPair=function(e){return n(e.lat,"lat")+" "+n(e.lon,"lon")},r.exports.coordToDMS=o},{}],3:[function(e,r,t){var n;n=this,function(e){"use strict";function s(e){return new Function("d","return {"+e.map(function(e,r){return JSON.stringify(e)+": d["+r+"]"}).join(",")+"}")}function r(i){var r=new RegExp('["'+i+"\n]"),p=i.charCodeAt(0);function t(o,e){var r,i,u={},a={},t=[],s=o.length,l=0,n=0;function f(){if(s<=l)return a;if(i)return i=!1,u;var e=l;if(34===o.charCodeAt(e)){for(var r=e;r++<s;)if(34===o.charCodeAt(r)){if(34!==o.charCodeAt(r+1))break;++r}return l=r+2,13===(t=o.charCodeAt(r+1))?(i=!0,10===o.charCodeAt(r+2)&&++l):10===t&&(i=!0),o.slice(e+1,r).replace(/""/g,'"')}for(;l<s;){var t,n=1;if(10===(t=o.charCodeAt(l++)))i=!0;else if(13===t)i=!0,10===o.charCodeAt(l)&&(++l,++n);else if(t!==p)continue;return o.slice(e,l-n)}return o.slice(e)}for(;(r=f())!==a;){for(var c=[];r!==u&&r!==a;)c.push(r),r=f();e&&null==(c=e(c,n++))||t.push(c)}return t}function n(e){return e.map(u).join(i)}function u(e){return null==e?"":r.test(e+="")?'"'+e.replace(/\"/g,'""')+'"':e}return{parse:function(e,i){var u,a;return(e=t(e,function(e,r){return u?u(e,r-1):(a=e,void(u=i?(n=i,o=s(t=e),function(e,r){return n(o(e),r,t)}):s(e)));var t,n,o})).columns=a,e},parseRows:t,format:function(e,t){var r,n,o;return null==t&&(r=e,n=Object.create(null),o=[],r.forEach(function(e){for(var r in e)r in n||o.push(n[r]=r)}),t=o),[t.map(u).join(i)].concat(e.map(function(r){return t.map(function(e){return u(r[e])}).join(i)})).join("\n")},formatRows:function(e){return e.map(n).join("\n")}}}var t=r(","),n=t.parse,o=t.parseRows,i=t.format,u=t.formatRows,a=r("\t"),l=a.parse,f=a.parseRows,t=a.format,a=a.formatRows;e.dsvFormat=r,e.csvParse=n,e.csvParseRows=o,e.csvFormat=i,e.csvFormatRows=u,e.tsvParse=l,e.tsvParseRows=f,e.tsvFormat=t,e.tsvFormatRows=a,Object.defineProperty(e,"__esModule",{value:!0})}("object"==typeof t&&void 0!==r?t:n.d3=n.d3||{})},{}]},{},[1])(1)});